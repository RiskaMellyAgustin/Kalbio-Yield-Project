{% extends "yieldapp/partials/base.html" %}
{% load static %}

{% block title %}Kelola Master Produk{% endblock %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'yieldapp/css/mstd_pages.css' %}">
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
    <h1 class="display-5 mb-0">Kelola Master Produk</h1>
    <div>
        <a href="{% url 'issue_list' %}" class="btn btn-outline-warning">Manajemen Isu</a>
        <a href="{% url 'notification_list' %}" class="btn btn-outline-info">Notifikasi</a>
        <a href="{% url 'dashboard' %}" class="btn btn-outline-success">Lihat Dasbor Analisis</a>
    </div>
</div>

<div class="mstd-container">
    <div class="form-card">
        <h2>Tambah Produk Baru</h2>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type-="submit" class="btn btn-primary w-100">Simpan Produk Baru</button>
        </form>
    </div>

    <div class="table-card">
        <div class="d-flex justify-content-between align-items-center">
            <h2>Daftar Produk & Target</h2>
            <a href="{% url 'upload_product' %}" class="btn btn-sm btn-success">
                <i class="bi bi-cloud-upload"></i> Upload CSV
            </a>
        </div>
        <div class="table-responsive mt-3">
            <table class="table table-hover">
                <thead class="table-light">
                    <tr>
                        <th>Kode Produk</th>
                        <th>Nama Produk</th>
                        <th>Theoretical Yield (pcs)</th>
                        <th>Target Yield (%)</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in products %}
                    <tr>
                        <td><strong>{{ product.product_code }}</strong></td>
                        <td>{{ product.name }}</td>
                        <td>{{ product.theoritical_yield_pcs }}</td>
                        <td>{{ product.target_yield_percent }}%</td>
                        <td>
                            <a href="{% url 'product_edit' product.pk %}" class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-pencil"></i> Edit
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5" class="text-center p-4">Belum ada data produk.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}