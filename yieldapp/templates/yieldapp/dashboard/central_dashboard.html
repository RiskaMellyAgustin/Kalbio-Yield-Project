{% comment %} {% load static %}
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Central Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; margin: 0; background-color: #f0f2f5; }
        .container { padding: 1.5em; max-width: 1400px; margin: auto; }
        h1, h2 { color: #1f2937; }
        .summary-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5em; margin: 1.5em 0; }
        .card { background-color: white; padding: 1.5em; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .card h3 { margin: 0 0 0.5em 0; color: #6b7280; font-size: 0.9rem; font-weight: 500; }
        .card p { margin: 0; font-size: 2.25rem; font-weight: 700; color: #111827; }
        .charts-grid { display: grid; grid-template-columns: 1fr 2fr; gap: 1.5em; }
        .chart-container { background-color: white; padding: 1.5em; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .nav-links a { margin-right: 20px; text-decoration: none; color: #3b82f6; font-weight: 500; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Central Dashboard (Ringkasan Total)</h1>
        <div class="nav-links">
            <a href="{% url 'home' %}">üè† Halaman Utama</a>
        </div>
        <hr style="border: 0; border-top: 1px solid #e5e7eb; margin: 1.5em 0;">
        
        <div class="summary-cards">
            <div class="card">
                <h3>Total Batch Selesai</h3>
                <p>{{ total_completed_batches }}</p>
            </div>
            <div class="card">
                <h3>Tingkat Keberhasilan Target</h3>
                <p>{{ achieved_rate }}%</p>
            </div>
            <div class="card">
                <h3>Total Isu Dilaporkan</h3>
                <p>{{ total_issues }}</p>
            </div>
        </div>

        <div class="charts-grid">
            <div class="chart-container">
                <h2>Status Target Batch</h2>
                <canvas id="donutChart"></canvas>
            </div>
            <div class="chart-container">
                <h2>Rata-rata Yield per Produk</h2>
                <canvas id="barChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // 1. Data untuk Donut Chart
        const donutCtx = document.getElementById('donutChart');
        const donutData = {{ donut_chart_data|safe }};
        new Chart(donutCtx, {
            type: 'doughnut',
            data: {
                labels: donutData.labels,
                datasets: [{
                    label: 'Jumlah Batch',
                    data: donutData.data,
                    backgroundColor: [
                        'rgba(40, 167, 69, 0.7)',  // Hijau untuk Tercapai
                        'rgba(220, 53, 69, 0.7)'   // Merah untuk Tidak Tercapai
                    ],
                    borderColor: 'white',
                    borderWidth: 2
                }]
            },
            options: { responsive: true, maintainAspectRatio: true }
        });

        // 2. Data untuk Bar Chart
        const barCtx = document.getElementById('barChart');
        const barData = {{ bar_chart_data|safe }};
        new Chart(barCtx, {
            type: 'bar',
            data: {
                labels: barData.labels,
                datasets: [{
                    label: 'Rata-rata Yield (%)',
                    data: barData.data,
                    backgroundColor: 'rgba(54, 162, 235, 0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: 'y', // Membuat bar menjadi horizontal agar nama produk mudah dibaca
                scales: {
                    x: { beginAtZero: true, max: 100 }
                }
            }
        });
    </script>
</body>
</html> {% endcomment %}